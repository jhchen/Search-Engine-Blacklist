<script type="text/javascript" src="common.js"></script>
<script>
chrome.extension.onRequest.addListener(function(request, sender, sendResponse) {
	if (request.method == "getBlacklist") {
		if (localStorage['blacklisted_sites']) {
			sendResponse(JSON.parse(localStorage['blacklisted_sites']));
		}
	} else if (request.method == "addToBlacklist") {
		blacklist = JSON.parse(localStorage['blacklisted_sites']);
		blacklist.push(request.site);
		localStorage['blacklisted_sites'] = JSON.stringify(blacklist);	
	}
	sendResponse([]);
});

if (!localStorage["version"] && !localStorage['blacklisted_sites']) {
    chrome.tabs.create({url: "options.html"}); 
    localStorage["version"] = "2.7.1";
}
</script>
